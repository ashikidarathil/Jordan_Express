<script>

  // Toggle sidebar on menu button click
  document.querySelector('.menu-toggle').addEventListener('click', function () {
    document.querySelector('.sidebar').classList.toggle('collapsed');

    // Store sidebar state in local storage
    const isCollapsed = document.querySelector('.sidebar').classList.contains('collapsed');
    localStorage.setItem('sidebarCollapsed', isCollapsed);
  });

  // Add active class to clicked nav link
  const navLinks = document.querySelectorAll('.nav-link');
  navLinks.forEach(link => {
    link.addEventListener('click', function (e) {
      e.preventDefault();

      // Remove active class from all links
      navLinks.forEach(l => l.classList.remove('active'));

      // Add active class to clicked link
      this.classList.add('active');

      // Store active link in local storage
      localStorage.setItem('activeLink', Array.from(navLinks).indexOf(this));
    });
  });

  // Restore sidebar state from local storage
  document.addEventListener('DOMContentLoaded', function () {
    // Check if sidebar should be collapsed
    const sidebarCollapsed = localStorage.getItem('sidebarCollapsed') === 'true';
    if (sidebarCollapsed) {
      document.querySelector('.sidebar').classList.add('collapsed');
    }

    // Restore active link
    const activeIndex = localStorage.getItem('activeLink');
    if (activeIndex !== null) {
      navLinks.forEach(l => l.classList.remove('active'));
      navLinks[activeIndex]?.classList.add('active');
    }

    // Add dropdown functionality for admin profile
    const adminProfile = document.querySelector('.admin-profile');
    if (adminProfile) {
      adminProfile.addEventListener('click', function () {
        // Create dropdown menu if it doesn't exist
        let dropdown = document.querySelector('.admin-dropdown');
        if (!dropdown) {
          dropdown = document.createElement('div');
          dropdown.className = 'admin-dropdown';
          dropdown.style.position = 'absolute';
          dropdown.style.top = '60px';
          dropdown.style.right = '20px';
          dropdown.style.backgroundColor = 'white';
          dropdown.style.borderRadius = '8px';
          dropdown.style.boxShadow = '0 4px 12px rgba(0, 0, 0, 0.1)';
          dropdown.style.padding = '10px 0';
          dropdown.style.zIndex = '1000';
          dropdown.style.minWidth = '150px';

          const options = [
            { icon: 'fas fa-user', text: 'Profile' },
            { icon: 'fas fa-cog', text: 'Settings' },
            { icon: 'fas fa-sign-out-alt', text: 'Logout' }
          ];

          options.forEach(option => {
            const item = document.createElement('div');
            item.style.padding = '10px 15px';
            item.style.display = 'flex';
            item.style.alignItems = 'center';
            item.style.cursor = 'pointer';
            item.style.transition = 'background-color 0.3s';

            item.innerHTML = `
                      <i class="${option.icon}" style="margin-right: 10px; color: #555; width: 20px;"></i>
                      <span style="color: #333;">${option.text}</span>
                  `;

            item.addEventListener('mouseover', function () {
              this.style.backgroundColor = '#f5f5f5';
            });

            item.addEventListener('mouseout', function () {
              this.style.backgroundColor = 'transparent';
            });

            item.addEventListener('click', function () {
              alert(`${option.text} clicked`);
              document.body.removeChild(dropdown);
            });

            dropdown.appendChild(item);
          });

          document.body.appendChild(dropdown);
        } else {
          document.body.removeChild(dropdown);
        }
      });

      // Close dropdown when clicking outside
      document.addEventListener('click', function (e) {
        const dropdown = document.querySelector('.admin-dropdown');
        const adminProfile = document.querySelector('.admin-profile');

        if (dropdown && !dropdown.contains(e.target) && !adminProfile.contains(e.target)) {
          document.body.removeChild(dropdown);
        }
      });
    }

    // Add tooltip functionality for collapsed sidebar
    const sidebar = document.querySelector('.sidebar');
    if (sidebar) {
      navLinks.forEach(link => {
        // Create tooltip
        const tooltip = document.createElement('div');
        tooltip.className = 'tooltip';
        tooltip.textContent = link.querySelector('span').textContent;
        tooltip.style.position = 'absolute';
        tooltip.style.left = '70px';
        tooltip.style.backgroundColor = '#333';
        tooltip.style.color = 'white';
        tooltip.style.padding = '5px 10px';
        tooltip.style.borderRadius = '4px';
        tooltip.style.fontSize = '12px';
        tooltip.style.opacity = '0';
        tooltip.style.pointerEvents = 'none';
        tooltip.style.transition = 'opacity 0.2s';
        tooltip.style.zIndex = '1000';
        tooltip.style.whiteSpace = 'nowrap';

        link.style.position = 'relative';
        link.appendChild(tooltip);

        // Show tooltip on hover when sidebar is collapsed
        link.addEventListener('mouseenter', function () {
          if (sidebar.classList.contains('collapsed')) {
            const linkRect = link.getBoundingClientRect();
            tooltip.style.top = (linkRect.height / 2 - tooltip.offsetHeight / 2) + 'px';
            tooltip.style.opacity = '1';
          }
        });

        link.addEventListener('mouseleave', function () {
          tooltip.style.opacity = '0';
        });
      });
    }
  });

</script>
</body>

</html>